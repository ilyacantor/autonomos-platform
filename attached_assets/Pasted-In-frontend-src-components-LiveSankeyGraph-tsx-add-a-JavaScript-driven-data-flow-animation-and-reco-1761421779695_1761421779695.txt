In frontend/src/components/LiveSankeyGraph.tsx, add a JavaScript-driven data-flow animation and recolor the 0→1 edges.

Goals

Highlight layer 0 → layer 1 edges in bright green (#00FF88, opacity 0.9).

Keep all other edges in existing cyan/teal tones.

When isRunning is true, create smooth motion along all edges using requestAnimationFrame.

Continue motion for ~2 seconds after isRunning becomes false, then stop.

No layout, zoom, or performance regressions.

Implementation

// near imports
import { useEffect, useRef, useState } from "react";

// inside component
const [animate, setAnimate] = useState(false);
const frameRef = useRef<number | null>(null);
const offsetRef = useRef(0);

useEffect(() => {
  if (isRunning) {
    setAnimate(true);
  } else {
    const t = setTimeout(() => setAnimate(false), 2000);
    return () => clearTimeout(t);
  }
}, [isRunning]);

// after D3 links are drawn
link
  .attr("stroke", d =>
    d.source.layer === 0 && d.target.layer === 1
      ? "#00FF88"
      : d.color || "#00C8FF"
  )
  .attr("stroke-opacity", d =>
    d.source.layer === 0 && d.target.layer === 1 ? 0.9 : 0.7
  )
  .attr("fill", "none")
  .attr("vector-effect", "non-scaling-stroke")
  .attr("stroke-width", d => Math.max(1, d.width || 1))
  .attr("stroke-dasharray", d => {
    const len = d3.select(this).node()?.getTotalLength?.() || 100;
    return `${len / 20} ${len / 10}`;
  });

// animation loop
if (frameRef.current) cancelAnimationFrame(frameRef.current);
const animateFlow = () => {
  if (animate) {
    offsetRef.current -= 1.5; // motion speed
    link.attr("stroke-dashoffset", offsetRef.current);
    frameRef.current = requestAnimationFrame(animateFlow);
  } else {
    link.attr("stroke-dashoffset", 0);
  }
};
if (animate) frameRef.current = requestAnimationFrame(animateFlow);


Guardrails

Don’t alter node data, layout, or zoom/pan logic.

Attach animation after links exist in DOM.

Cancel any previous animation frame on unmount or redraw.

Definition of Done

0→1 edges appear bright green and clearly distinct.

All other edges keep original cyan/teal.

When running, visible flow motion moves smoothly along edges.

Motion persists ≈ 2 s after stop.

No frame-rate or layout degradation.