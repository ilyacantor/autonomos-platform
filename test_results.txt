============================= test session starts ==============================
platform linux -- Python 3.11.13, pytest-8.4.2, pluggy-1.6.0 -- /nix/store/2lcqw1d28vklbk8ikiwad28iq2smwndv-python-wrapped-0.1.0/bin/python3
cachedir: .pytest_cache
rootdir: /home/runner/workspace
plugins: anyio-4.11.0, cov-7.0.0, asyncio-1.2.0
asyncio: mode=Mode.STRICT, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 93 items

tests/test_aam_drift_automated.py::test_aam_schema_drift_automated PASSED [  1%]
tests/test_auth.py::TestUserRegistration::test_register_new_user_creates_tenant_and_user PASSED [  2%]
tests/test_auth.py::TestUserRegistration::test_register_duplicate_email_fails PASSED [  3%]
tests/test_auth.py::TestUserRegistration::test_register_weak_password_validation PASSED [  4%]
tests/test_auth.py::TestLogin::test_login_with_valid_credentials_returns_jwt PASSED [  5%]
tests/test_auth.py::TestLogin::test_login_with_wrong_password_fails PASSED [  6%]
tests/test_auth.py::TestLogin::test_login_with_nonexistent_user_fails PASSED [  7%]
tests/test_auth.py::TestCurrentUser::test_get_current_user_with_valid_token PASSED [  8%]
tests/test_auth.py::TestCurrentUser::test_get_current_user_without_token_fails FAILED [  9%]
tests/test_auth.py::TestCurrentUser::test_get_current_user_with_invalid_token_fails PASSED [ 10%]
tests/test_auth.py::TestCurrentUser::test_get_current_user_with_malformed_token_fails FAILED [ 11%]
tests/test_canonical_processor.py::TestEventNormalization::test_normalize_event_basic PASSED [ 12%]
tests/test_canonical_processor.py::TestEventNormalization::test_numeric_string_preservation FAILED [ 13%]
tests/test_canonical_processor.py::TestEventNormalization::test_backward_compatibility PASSED [ 15%]
tests/test_canonical_processor.py::TestEventValidation::test_validate_event_success PASSED [ 16%]
tests/test_canonical_processor.py::TestEventValidation::test_validate_event_failure_missing_fingerprint PASSED [ 17%]
tests/test_canonical_processor.py::TestMetadataEnrichment::test_enrich_metadata PASSED [ 18%]
tests/test_canonical_processor.py::TestMetadataEnrichment::test_data_lineage_tracking PASSED [ 19%]
tests/test_canonical_processor.py::TestMetadataEnrichment::test_confidence_scoring PASSED [ 20%]
tests/test_canonical_processor.py::TestProcessingPipeline::test_process_events_pipeline PASSED [ 21%]
tests/test_canonical_processor.py::TestProcessingPipeline::test_process_events_empty_list PASSED [ 22%]
tests/test_canonical_processor.py::TestCanonicalProcessorUnit::test_processor_initialization PASSED [ 23%]
tests/test_dcl_entity_unification.py::test_dcl_entity_unification PASSED [ 24%]
tests/test_dcl_unification_e2e.py::test_dcl_unification_e2e PASSED       [ 25%]
tests/test_dcl_unification_e2e.py::test_multi_tenant_isolation PASSED    [ 26%]
tests/test_drift_detector.py::TestSchemaFingerprinting::test_schema_fingerprinting_sorted_fields PASSED [ 27%]
tests/test_drift_detector.py::TestSchemaFingerprinting::test_fingerprint_generation_consistency PASSED [ 29%]
tests/test_drift_detector.py::TestDriftDetection::test_no_drift_on_first_run PASSED [ 30%]
tests/test_drift_detector.py::TestDriftDetection::test_drift_detected_new_field FAILED [ 31%]
tests/test_drift_detector.py::TestDriftDetection::test_drift_detected_removed_field FAILED [ 32%]
tests/test_drift_detector.py::TestSeverityClassification::test_severity_classification_low PASSED [ 33%]
tests/test_drift_detector.py::TestSeverityClassification::test_severity_classification_medium PASSED [ 34%]
tests/test_drift_detector.py::TestSeverityClassification::test_severity_classification_high PASSED [ 35%]
tests/test_drift_detector.py::TestRedisPersistence::test_redis_persistence PASSED [ 36%]
tests/test_drift_detector.py::TestRedisPersistence::test_drift_event_structure PASSED [ 37%]
tests/test_drift_detector.py::TestDriftDetectorUnit::test_detector_initialization PASSED [ 38%]
tests/test_drift_detector.py::TestDriftDetectorUnit::test_build_redis_key_format PASSED [ 39%]
tests/test_isolation.py::TestCrossTenantIsolation::test_user_from_tenant_b_cannot_access_tenant_a_task PASSED [ 40%]
tests/test_isolation.py::TestCrossTenantIsolation::test_user_from_tenant_b_cannot_delete_tenant_a_task PASSED [ 41%]
tests/test_isolation.py::TestCrossTenantIsolation::test_tenant_can_only_see_their_own_user_info PASSED [ 43%]
tests/test_isolation.py::TestCrossTenantIsolation::test_multiple_tasks_across_tenants_remain_isolated PASSED [ 44%]
tests/test_isolation.py::TestCrossTenantIsolation::test_task_with_sensitive_data_not_leaked_across_tenants PASSED [ 45%]
tests/test_isolation.py::TestAuthenticationIsolation::test_jwt_token_contains_correct_tenant_scope PASSED [ 46%]
tests/test_phase4_integration.py::TestCanonicalEventFlow::test_csv_to_canonical_events PASSED [ 47%]
tests/test_phase4_integration.py::TestCanonicalEventFlow::test_canonical_to_redis_streams PASSED [ 48%]
tests/test_phase4_integration.py::TestMetadataExtraction::test_redis_to_dcl_metadata_extraction FAILED [ 49%]
tests/test_phase4_integration.py::TestMetadataStorage::test_metadata_redis_storage PASSED [ 50%]
tests/test_phase4_integration.py::TestMetadataStorage::test_metadata_duckdb_storage PASSED [ 51%]
tests/test_phase4_integration.py::TestAgentContext::test_metadata_to_agent_context FAILED [ 52%]
tests/test_phase4_integration.py::TestAgentContext::test_agent_output_quality_insights PASSED [ 53%]
tests/test_phase4_integration.py::TestEndToEndFlow::test_end_to_end_flow FAILED [ 54%]
tests/test_phase4_integration.py::TestEndToEndFlow::test_drift_detection_integration PASSED [ 55%]
tests/test_phase4_integration.py::TestEndToEndFlow::test_repair_agent_integration PASSED [ 56%]
tests/test_phase4_integration.py::TestPhase4Integration::test_integration_marker PASSED [ 58%]
tests/test_repair_agent.py::TestConfidenceScoring::test_confidence_scoring_high PASSED [ 59%]
tests/test_repair_agent.py::TestConfidenceScoring::test_confidence_scoring_medium PASSED [ 60%]
tests/test_repair_agent.py::TestConfidenceScoring::test_confidence_scoring_low PASSED [ 61%]
tests/test_repair_agent.py::TestHITLWorkflow::test_hitl_queue_enforcement PASSED [ 62%]
tests/test_repair_agent.py::TestHITLWorkflow::test_auto_apply_high_confidence PASSED [ 63%]
tests/test_repair_agent.py::TestHITLWorkflow::test_reject_low_confidence PASSED [ 64%]
tests/test_repair_agent.py::TestLLMIntegration::test_llm_field_mapping PASSED [ 65%]
tests/test_repair_agent.py::TestRAGIntelligence::test_rag_intelligence PASSED [ 66%]
tests/test_repair_agent.py::TestRepairPersistence::test_repair_history_persistence PASSED [ 67%]
tests/test_repair_agent.py::TestRepairAgentUnit::test_agent_initialization PASSED [ 68%]
tests/test_repair_agent.py::TestRepairAgentUnit::test_confidence_thresholds PASSED [ 69%]
tests/test_repair_agent.py::TestRepairAgentUnit::test_repair_batch_aggregation PASSED [ 70%]
tests/test_tasks.py::TestTaskCreation::test_create_basic_task_with_jwt PASSED [ 72%]
tests/test_tasks.py::TestTaskCreation::test_create_task_without_authentication_fails FAILED [ 73%]
tests/test_tasks.py::TestTaskCreation::test_create_task_with_callback_url PASSED [ 74%]
tests/test_tasks.py::TestTaskCreation::test_create_task_with_retries PASSED [ 75%]
tests/test_tasks.py::TestTaskCreation::test_create_task_with_chaining PASSED [ 76%]
tests/test_tasks.py::TestTaskRetrieval::test_get_task_by_id_with_jwt PASSED [ 77%]
tests/test_tasks.py::TestTaskRetrieval::test_get_task_without_authentication_fails FAILED [ 78%]
tests/test_tasks.py::TestTaskRetrieval::test_get_nonexistent_task_returns_404 PASSED [ 79%]
tests/test_tasks.py::TestTaskRetrieval::test_get_task_shows_processing_status PASSED [ 80%]
tests/test_tasks.py::TestTaskCancellation::test_cancel_task_with_jwt PASSED [ 81%]
tests/test_tasks.py::TestTaskCancellation::test_cancel_task_without_authentication_fails FAILED [ 82%]
tests/test_tasks.py::TestTaskCancellation::test_cancel_nonexistent_task_returns_404 PASSED [ 83%]
tests/test_tasks.py::TestTaskProcessing::test_task_processes_successfully FAILED [ 84%]
tests/test_tasks.py::TestComplexTaskScenarios::test_task_lifecycle_from_creation_to_completion 